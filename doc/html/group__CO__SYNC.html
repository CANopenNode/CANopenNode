<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CANopenNode: SYNC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CANopenNode
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__CO__SYNC.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SYNC<div class="ingroups"><a class="el" href="group__CO__CANopen.html">CANopen stack</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>CANopen SYNC object protocol.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:CO__SYNC_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CO__SYNC_8h.html">CO_SYNC.h</a></td></tr>
<tr class="memdesc:CO__SYNC_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">CANopen SYNC object protocol. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SYNC producer and consumer object.  <a href="structCO__SYNC__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf1a78ad9551a2d89154819f207abe225"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__CO__driver.html#ga1cb2d3466eb0c6d267f3b5ff1a0d9532">CO_ReturnError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CO__SYNC.html#gaf1a78ad9551a2d89154819f207abe225">CO_SYNC_init</a> (<a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a> *SYNC, <a class="el" href="structCO__EM__t.html">CO_EM_t</a> *em, <a class="el" href="structCO__SDO__t.html">CO_SDO_t</a> *SDO, uint8_t *operatingState, uint32_t COB_ID_SYNCMessage, uint32_t communicationCyclePeriod, uint8_t synchronousCounterOverflowValue, <a class="el" href="structCO__CANmodule__t.html">CO_CANmodule_t</a> *CANdevRx, uint16_t CANdevRxIdx, <a class="el" href="structCO__CANmodule__t.html">CO_CANmodule_t</a> *CANdevTx, uint16_t CANdevTxIdx)</td></tr>
<tr class="memdesc:gaf1a78ad9551a2d89154819f207abe225"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize SYNC object.  <a href="#gaf1a78ad9551a2d89154819f207abe225">More...</a><br /></td></tr>
<tr class="separator:gaf1a78ad9551a2d89154819f207abe225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3af3623807d0f59239940f03259125ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CO__SYNC.html#ga3af3623807d0f59239940f03259125ec">CO_SYNC_initCallback</a> (<a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a> *SYNC, void(*cbSync)(<a class="el" href="group__CO__dataTypes.html#ga449976458a084f880dc8e3d29e7eb6f5">bool_t</a> syncReceived))</td></tr>
<tr class="memdesc:ga3af3623807d0f59239940f03259125ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize SYNC callback function.  <a href="#ga3af3623807d0f59239940f03259125ec">More...</a><br /></td></tr>
<tr class="separator:ga3af3623807d0f59239940f03259125ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47f7425d84a2bb34c5f2fde30eb418ba"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CO__SYNC.html#ga47f7425d84a2bb34c5f2fde30eb418ba">CO_SYNC_process</a> (<a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a> *SYNC, uint32_t timeDifference_us, uint32_t ObjDict_synchronousWindowLength)</td></tr>
<tr class="memdesc:ga47f7425d84a2bb34c5f2fde30eb418ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process SYNC communication.  <a href="#ga47f7425d84a2bb34c5f2fde30eb418ba">More...</a><br /></td></tr>
<tr class="separator:ga47f7425d84a2bb34c5f2fde30eb418ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>CANopen SYNC object protocol. </p>
<p>For CAN identifier see <a class="el" href="group__CO__CANopen.html#ga01dd35ae53fd2209ceccabdc8bf8dd06" title="Default CANopen identifiers. ">CO_Default_CAN_ID_t</a></p>
<p>SYNC message is used for synchronization of the nodes on network. One node can be SYNC producer, others can be SYNC consumers. Synchronous TPDOs are transmitted after the CANopen SYNC message. Synchronous received PDOs are accepted(copied to OD) immediatelly after the reception of the next SYNC message.</p>
<h4>Contents of SYNC message</h4>
<p>By default SYNC message has no data. If <em>Synchronous counter overflow value</em> from Object dictionary (index 0x1019) is different than 0, SYNC message has one data byte: <em>counter</em> incremented by 1 with every SYNC transmission.</p>
<h4>SYNC in CANopenNode</h4>
<p>If callback is configured by <a class="el" href="group__CO__SYNC.html#ga3af3623807d0f59239940f03259125ec" title="Initialize SYNC callback function. ">CO_SYNC_initCallback()</a>, then it is called from CO_SYNC_receive thread, after SYNC message is received. Or, if node is SYNC producer, function is called just before SYNC message is transmitted. Usage of callback is microcontroller specific. It may, for example, temporary disable CAN message reception. Reception is then reenabled after all RPDOs are processed. This is necessary because reception of PDOs must be disabled after sync message, before old RPDOs are processed completelly.</p>
<p>Besides callback, information about SYNC message is returned also from <a class="el" href="group__CO__SYNC.html#ga47f7425d84a2bb34c5f2fde30eb418ba" title="Process SYNC communication. ">CO_SYNC_process()</a> function. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf1a78ad9551a2d89154819f207abe225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf1a78ad9551a2d89154819f207abe225">&#9670;&nbsp;</a></span>CO_SYNC_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__CO__driver.html#ga1cb2d3466eb0c6d267f3b5ff1a0d9532">CO_ReturnError_t</a> CO_SYNC_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a> *&#160;</td>
          <td class="paramname"><em>SYNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCO__EM__t.html">CO_EM_t</a> *&#160;</td>
          <td class="paramname"><em>em</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCO__SDO__t.html">CO_SDO_t</a> *&#160;</td>
          <td class="paramname"><em>SDO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>operatingState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>COB_ID_SYNCMessage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>communicationCyclePeriod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>synchronousCounterOverflowValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCO__CANmodule__t.html">CO_CANmodule_t</a> *&#160;</td>
          <td class="paramname"><em>CANdevRx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>CANdevRxIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCO__CANmodule__t.html">CO_CANmodule_t</a> *&#160;</td>
          <td class="paramname"><em>CANdevTx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>CANdevTxIdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize SYNC object. </p>
<p>Function must be called in the communication reset section.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SYNC</td><td>This object will be initialized. </td></tr>
    <tr><td class="paramname">em</td><td>Emergency object. </td></tr>
    <tr><td class="paramname">SDO</td><td>SDO server object. </td></tr>
    <tr><td class="paramname">operatingState</td><td>Pointer to variable indicating CANopen device NMT internal state. </td></tr>
    <tr><td class="paramname">COB_ID_SYNCMessage</td><td>From Object dictionary (index 0x1005). </td></tr>
    <tr><td class="paramname">communicationCyclePeriod</td><td>From Object dictionary (index 0x1006). </td></tr>
    <tr><td class="paramname">synchronousCounterOverflowValue</td><td>From Object dictionary (index 0x1019). </td></tr>
    <tr><td class="paramname">CANdevRx</td><td>CAN device for SYNC reception. </td></tr>
    <tr><td class="paramname">CANdevRxIdx</td><td>Index of receive buffer in the above CAN device. </td></tr>
    <tr><td class="paramname">CANdevTx</td><td>CAN device for SYNC transmission. </td></tr>
    <tr><td class="paramname">CANdevTxIdx</td><td>Index of transmit buffer in the above CAN device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__CO__driver.html#ga1cb2d3466eb0c6d267f3b5ff1a0d9532" title="Return values of some CANopen functions. ">CO_ReturnError_t</a>: CO_ERROR_NO or CO_ERROR_ILLEGAL_ARGUMENT. </dd></dl>

</div>
</div>
<a id="ga3af3623807d0f59239940f03259125ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3af3623807d0f59239940f03259125ec">&#9670;&nbsp;</a></span>CO_SYNC_initCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CO_SYNC_initCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a> *&#160;</td>
          <td class="paramname"><em>SYNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="group__CO__dataTypes.html#ga449976458a084f880dc8e3d29e7eb6f5">bool_t</a> syncReceived)&#160;</td>
          <td class="paramname"><em>cbSync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize SYNC callback function. </p>
<p>Function initializes optional callback function, which executes after the SYNC.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SYNC</td><td>This object. </td></tr>
    <tr><td class="paramname">cbSync</td><td>Callback function, which will be called just after the presence of CANopen SYNC message on the bus. If SYNC was received, syncReceived will be true, if SYNC will be transmitted, syncReceived will be false. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga47f7425d84a2bb34c5f2fde30eb418ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47f7425d84a2bb34c5f2fde30eb418ba">&#9670;&nbsp;</a></span>CO_SYNC_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t CO_SYNC_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCO__SYNC__t.html">CO_SYNC_t</a> *&#160;</td>
          <td class="paramname"><em>SYNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeDifference_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ObjDict_synchronousWindowLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process SYNC communication. </p>
<p>Function must be called cyclically.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SYNC</td><td>This object. </td></tr>
    <tr><td class="paramname">timeDifference_us</td><td>Time difference from previous function call in [microseconds]. </td></tr>
    <tr><td class="paramname">ObjDict_synchronousWindowLength</td><td><em>Synchronous window length</em> variable from Object dictionary (index 0x1007).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0: No special meaning. </dd>
<dd>
1: New SYNC message recently received or was just transmitted. </dd>
<dd>
2: SYNC time was just passed out of window. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 2 2017 14:12:28 for CANopenNode by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
